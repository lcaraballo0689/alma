import{_ as F,h as t,i as f,a as n,j as s,k as e,m as d,c as u,F as v,l as h,t as c,e as x,b,g as I,S as N,u as B}from"./main-m8i741CU.js";const L={name:"SettingsView",data(){return{profileFields:[{key:"nombre",label:"Nombre"},{key:"email",label:"Correo electrónico"},{key:"telefono",label:"Teléfono"},{key:"direccion",label:"Dirección"}],useAuthStore:B(),password:"",confirmPassword:"",passwordError:"",confirmPasswordError:"",showPassword:!1,showConfirmPassword:!1}},computed:{passwordChecks(){const o=this.password||"";return[{text:"Al menos 8 caracteres",valid:o.length>=8},{text:"Contiene letra minúscula",valid:/[a-z]/.test(o)},{text:"Contiene letra mayúscula",valid:/[A-Z]/.test(o)},{text:"Contiene número",valid:/\d/.test(o)},{text:"Contiene símbolo",valid:/[\W_]/.test(o)}]},isFormValid(){return!this.passwordError&&!this.confirmPasswordError}},methods:{validatePassword(){const o=this.password||"";o&&!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{8,}$/.test(o)?this.passwordError="La contraseña no cumple todos los requisitos.":this.passwordError=""},validateConfirmPassword(){this.password&&this.confirmPassword&&this.password!==this.confirmPassword?this.confirmPasswordError="Las contraseñas no coinciden.":this.confirmPasswordError=""},async updatePassword(){if(this.isFormValid)try{await N.post("/api/usuarios/updatepass/"+this.useAuthStore.user.id,{password:this.password}),this.password="",this.confirmPassword="",this.passwordError="",this.confirmPasswordError=""}catch(o){console.error("Error al actualizar la contraseña:",o),this.passwordError="Error al actualizar la contraseña. Inténtalo de nuevo."}}}},U={key:0,class:"list-unstyled mt-2",style:{"list-style":"none"}},D={class:"ms-1"},T={key:1,class:"text-danger small"};function W(o,r,Z,j,l,i){const m=t("v-card-title"),y=t("v-list-item-title"),C=t("v-list-item-subtitle"),P=t("v-list-item-content"),V=t("v-list-item"),k=t("v-list"),_=t("v-card-text"),p=t("v-card"),w=t("v-text-field"),E=t("v-form"),g=t("v-btn"),A=t("v-container"),z=t("v-main"),S=t("v-app");return n(),f(S,null,{default:s(()=>[e(z,null,{default:s(()=>[e(A,null,{default:s(()=>[e(p,{class:"mb-6"},{default:s(()=>[e(m,null,{default:s(()=>r[3]||(r[3]=[d("Perfil")])),_:1}),e(_,null,{default:s(()=>[e(k,{dense:""},{default:s(()=>[(n(!0),u(v,null,h(l.profileFields,a=>(n(),f(V,{key:a.key},{default:s(()=>[e(P,null,{default:s(()=>[e(y,null,{default:s(()=>[d(c(a.label),1)]),_:2},1024),e(C,null,{default:s(()=>[d(c(l.useAuthStore.user[a.key]),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(p,{class:""},{default:s(()=>[e(m,null,{default:s(()=>r[4]||(r[4]=[d("Actualizar Contraseña")])),_:1}),e(_,null,{default:s(()=>[e(E,{ref:"form",modelValue:o.valid,"onUpdate:modelValue":r[2]||(r[2]=a=>o.valid=a),"lazy-validation":""},{default:s(()=>[e(w,{modelValue:l.password,"onUpdate:modelValue":r[0]||(r[0]=a=>l.password=a),type:l.showPassword?"text":"password",label:"Nueva Contraseña",onInput:i.validatePassword},null,8,["modelValue","type","onInput"]),l.password?(n(),u("ul",U,[(n(!0),u(v,null,h(i.passwordChecks,a=>(n(),u("li",{key:a.text},[b("i",{class:I(a.valid?"bx bx-check text-success":"bx bx-x text-danger")},null,2),b("small",D,c(a.text),1)]))),128))])):x("",!0),l.passwordError?(n(),u("div",T,c(l.passwordError),1)):x("",!0),e(w,{class:"mt-2",modelValue:l.confirmPassword,"onUpdate:modelValue":r[1]||(r[1]=a=>l.confirmPassword=a),type:l.showConfirmPassword?"text":"password",label:"Confirmar Contraseña",onInput:i.validateConfirmPassword},null,8,["modelValue","type","onInput"])]),_:1},8,["modelValue"]),e(g,{color:"success",disabled:!i.isFormValid,onClick:i.updatePassword},{default:s(()=>r[5]||(r[5]=[d("Actualizar")])),_:1},8,["disabled","onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const G=F(L,[["render",W],["__scopeId","data-v-5b5504f6"]]);export{G as default};
